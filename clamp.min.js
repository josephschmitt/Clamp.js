/*!
* Clamp.js 0.5.1
*
* Copyright 2011-2013, Joseph Schmitt http://joe.sh
* Released under the WTFPL license
* http://sam.zoy.org/wtfpl/
*/
(function(){function a(g,h){h=h||{};var s=this,j=window,e={clamp:h.clamp||2,useNativeClamp:typeof(h.useNativeClamp)!="undefined"?h.useNativeClamp:true,splitOnChars:h.splitOnChars||[".","-","–","—"," "],animate:h.animate||false,truncationChar:h.truncationChar||"…",truncationHTML:h.truncationHTML},q=g.style,y=g.innerHTML,u=typeof(g.style.webkitLineClamp)!="undefined",d=e.clamp,l=d.indexOf&&(d.indexOf("px")>-1||d.indexOf("em")>-1),m;if(e.truncationHTML){m=document.createElement("span");m.innerHTML=e.truncationHTML}function t(z,A){if(!j.getComputedStyle){j.getComputedStyle=function(B,C){this.el=B;this.getPropertyValue=function(E){var D=/(\-([a-z]){1})/g;if(E=="float"){E="styleFloat"}if(D.test(E)){E=E.replace(D,function(){return arguments[2].toUpperCase()})}return B.currentStyle&&B.currentStyle[E]?B.currentStyle[E]:null};return this}}return j.getComputedStyle(z,null).getPropertyValue(A)}function i(z){var A=z||g.clientHeight,B=n(g);return Math.max(Math.floor(A/B),0)}function w(z){var A=n(g);return A*z}function n(A){var z=t(A,"line-height");if(z=="normal"){z=parseInt(t(A,"font-size"))*1.2}return parseInt(z)}var c=e.splitOnChars.slice(0),v=c[0],p,x;function b(z){if(z.lastChild.children&&z.lastChild.children.length>0){return b(Array.prototype.slice.call(z.children).pop())}else{if(!z.lastChild||!z.lastChild.nodeValue||z.lastChild.nodeValue==""||z.lastChild.nodeValue==e.truncationChar){z.lastChild.parentNode.removeChild(z.lastChild);return b(g)}else{return z.lastChild}}}function f(C,B){if(!B){return}function A(){c=e.splitOnChars.slice(0);v=c[0];p=null;x=null}var z=C.nodeValue.replace(e.truncationChar,"");if(!p){if(c.length>0){v=c.shift()}else{v=""}p=z.split(v)}if(p.length>1){x=p.pop();if(g.clientHeight>B){k(C,p.join(v))}else{C.nodeValue=p.join(v)}}else{p=null}if(m){C.nodeValue=C.nodeValue.replace(e.truncationChar,"");g.innerHTML=C.nodeValue+" "+m.innerHTML+e.truncationChar}if(p){if(g.clientHeight<=B){if(c.length>=0&&v!=""){k(C,p.join(v)+v+x);p=null}else{return g.innerHTML}}}else{if(v==""){k(C,"");C=b(g);A()}}if(e.animate){setTimeout(function(){f(C,B)},e.animate===true?10:e.animate)}else{return f(C,B)}}function k(z,A){z.nodeValue=A+e.truncationChar}if(d=="auto"){d=i()}else{if(l){d=i(parseInt(d))}}var o;if(u&&e.useNativeClamp){q.overflow="hidden";q.textOverflow="ellipsis";q.webkitBoxOrient="vertical";q.display="-webkit-box";q.webkitLineClamp=d;if(l){q.height=e.clamp+"px"}}else{var r=w(d);if(r<=g.clientHeight){o=f(b(g),r)}}return{original:y,clamped:o}}if(typeof define==="function"&&define.amd){define("clamp",[],function(){return a})}else{window.$clamp=a}})();