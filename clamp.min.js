/*!
* Clamp.js 0.5
*
* Copyright 2011, Joseph Schmitt http://reusablebits.com, http://josephschmitt.me
* Released under the WTFPL license
* http://sam.zoy.org/wtfpl/
*/
(function(){var a={getLineHeight:function(d){var c=this.computeStyle(d,"line-height");if(c=="normal"){c=parseInt(this.computeStyle(d,"font-size"))*1.2}return parseInt(c)},computeStyle:function(c,d){if(!window.getComputedStyle){window.getComputedStyle=function(e,f){this.el=e;this.getPropertyValue=function(h){var g=/(\-([a-z]){1})/g;if(h=="float"){h="styleFloat"}if(g.test(h)){h=h.replace(g,function(){return arguments[2].toUpperCase()})}return e.currentStyle&&e.currentStyle[h]?e.currentStyle[h]:null};return this}}return window.getComputedStyle(c,null).getPropertyValue(d)},getMaxLines:function(e,c){var d=c||e.clientHeight,f=a.getLineHeight(e);return Math.max(Math.floor(d/f),0)},getMaxHeight:function(d,c){var e=a.getLineHeight(d);return e*c}};function b(h,i){i=i||{};var p=this,j=window,f={lines:i.lines||2,useNativeClamp:typeof(i.useNativeClamp)!="undefined"?i.useNativeClamp:true,splitOnChars:i.splitOnChars||[".","-","–","—"," "],animate:i.animate||false},n=h.style,r=h.innerHTML,q=typeof(h.style.webkitLineClamp)!="undefined",e=f.lines,k=e.indexOf&&(e.indexOf("px")>-1||e.indexOf("em")>-1);var d=f.splitOnChars.slice(0),s=d[0],m,t;function c(u){if(u.lastChild.children&&u.lastChild.children.length>0){return c(Array.prototype.slice.call(u.children).pop())}else{if(!u.lastChild||!u.lastChild.nodeValue||u.lastChild.nodeValue==""||u.lastChild.nodeValue=="…"){u.lastChild.parentNode.removeChild(u.lastChild);return c(h)}else{return u.lastChild}}}function g(x,w){if(!w){return}function v(){d=f.splitOnChars.slice(0);s=d[0];m=null;t=null}var u=x.nodeValue.replace(/…/,"");if(!m){if(d.length>0){s=d.shift()}else{s=""}m=u.split(s)}if(m.length>1){t=m.pop();l(x,m.join(s))}else{m=null}if(m){if(h.clientHeight<=w){if(d.length>=0&&s!=""){l(x,m.join(s)+s+t);m=null}else{return false}}}else{if(s==""){l(x,"");x=c(h);v()}}if(f.animate){setTimeout(function(){g(x,w)},f.animate===true?10:f.animate)}else{g(x,w)}}function l(u,v){u.nodeValue=v+"…"}if(e=="auto"){e=a.getMaxLines(h)}else{if(k){e=a.getMaxLines(h,parseInt(e))}}if(q&&f.useNativeClamp){n.overflow="hidden";n.textOverflow="ellipsis";n.webkitBoxOrient="vertical";n.display="-webkit-box";n.webkitLineClamp=e;if(k){n.height=f.lines+"px"}}else{var o=a.getMaxHeight(h,e);if(o<=h.clientHeight){g(c(h),o)}}}window.$clamp=b;window.clampUtils=a})();
